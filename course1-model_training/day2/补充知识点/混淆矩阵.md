## Confusing Matrix 混淆矩阵

混淆矩阵（Confusion Matrix）是用来评估分类模型性能的工具，特别是在二分类和多分类问题中。


### 1 二分类混淆矩阵
在二分类问题中，混淆矩阵通常是一个 `2×2` 的矩阵，包含四个主要元素：


||实际为正类 (Positive)|	实际为负类 (Negative)
|:--:|:--:|:--:|
预测为正类 (Positive)	|`True Positive`, `TP` | `False Positive`, `FP` 
预测为负类 (Negative)	|`False Negative`, `FN` | `True Negative`, `TN`

这些值的含义如下：
- `TP (True Positive)`：正确地预测为正类的样本数
- `TN (True Negative)`：正确地预测为负类的样本数
- `FP (False Positive)`：错误地预测为正类的样本数（实际上是负类）
- `FN (False Negative)`：错误地预测为负类的样本数（实际上是正类）

### 2 计算指标
从混淆矩阵中可以推导出一系列常用的性能指标，用于衡量分类模型的效果：

以肿瘤 `恶性/Positive/阳性` `良性/Negative/阴性` 预测为例
#### 2.1 准确率（Accuracy）
准确率表示模型预测正确的总体比例，不区分是否漏诊或误诊，只关心整体正确率。

$$
\text { Accuracy }=\frac{T P+T N}{T P+T N+F P+F N}
$$

>Breast Cancer



假设总共有 1000 名患者
- 800 名患者 `良性肿瘤`
- 200 名患者 `恶性肿瘤`

模型正确地预测了 850 名患者的病情（无论是 `恶性` 还是 `良性`）。这包括了正类和负类的正确预测。

那么准确率 是：85%

准确率高说明整体预测比较准确，但这并不能告诉你具体哪一类的表现好，尤其是在类别不平衡时（例如更多的患者没有癌症时），准确率可能看起来不错，但实际对癌症患者的预测可能不理想。


#### 2.2 精确率（Precision）

$$
\text { Precision }=\frac{T P}{T P+F P}
$$

>Breast Cancer
- 判断有没有 `误诊`
- 以 `预测为 恶性肿瘤` 数量为基础，看里面有多少正确的
    - `精确率高`: 模型预测为 `恶性肿瘤` 的患者大部分都是准确的，`误诊` 的情况较少
    - `精确率低`: 很多健康患者被错误地诊断为 `恶性肿瘤`，可能导致不必要的检查或治疗


#### 2.3 召回率（Recall）或 灵敏度（Sensitivity）

$$
\text { Recall }=\frac{T P}{T P+F N}
$$

>Breast Cancer
- 判断有没有 `漏诊`
- 以 `标签为 恶性肿瘤` 数量为基础，看里面有多少正确的
    - `召回率高`: 意味着模型能够识别出大多数的 `恶性肿瘤` 患者，`漏诊` 的情况较少
    - `召回率低`: 意味着有很多 `恶性肿瘤` 患者没有被模型识别出来，可能导致延误治疗，产生严重后果



#### 2.4 F1分数（F1 Score）
`F1` 分数是精确率和召回率的 `调和平均数`，适用于处理精确率和召回率之间的权衡

$$
\text { F1 }=2 \times \frac{\text { Precision } \times \text { Recall }}{\text { Precision }+ \text { Recall }}
$$




>`F1－score` 的取值范围

$$
0 \leq \mathrm{F} 1 \text {-score } \leq 1
$$

-  `1.0` $ \rightarrow$ 模型完美：所有正例都预测对，且没有误报
-  `0.0` $\rightarrow$ 模型极差：要么完全没预测对，要么 `precision` 或 `recall` 为 `0`
-  `0.5` 左右 $\rightarrow$ 性能一般，多用于不平衡数据集参考
- 接近 `0` $\rightarrow$ 模型几乎没用

>`F1－score` 的大小含义
- 高 `F1－score`（接近 `1`）
    - 模型既有高 `Precision`，也有高 `Recall`
    - 几乎所有正类都被捕获，而且误报少
    - 说明模型在整体分类上表现优秀
- 低 `F1－score`（接近 `0`）
    - 模型要么漏报严重，要么误报严重
    - `Precision` 和 `Recall` 其中之一或两者都很低
    - 说明模刑难以有效区分正负样本
