## 法律模型 Benchmark 设计

##### 一句话答案（先给结论）

> **这种法律判决预测 / 推理任务，不是“生成好不好看”，而是要评 6 类能力：**

1. **罪名是否判对**
2. **法条是否引用正确**
3. **事实 → 法条的适配是否成立**
4. **结论是否在法定裁量区间内**
5. **推理结构是否合规（法律三段论）**
6. **是否出现法律幻觉或越权判断**



### 一、这个任务“本质上是什么 benchmark？”

这是一个**典型的「司法推理 benchmark」**，不是普通 QA。

#### 任务定义（非常重要）

> **输入**：案件事实
> **隐含前提**：适用法条
> **输出**：

* 罪名判断
* 法律依据
* 判罚区间（不是具体刑期）

👉 **这是一个「弱监督 + 规则强约束」任务**

### 二、这类法律微调，应该评什么？（6 个维度）

#### ① 罪名判断是否正确（核心指标）

##### ✔ 这是第一优先级

例如：

| 样本                 | 正确罪名         | 模型输出     |
| ------------------ | ------------ | -------- |
| judgement_predit-1 | 以危险方法危害公共安全罪 | ✅ 正确     |
| judgement_predit-2 | 放火罪（未遂）      | ⚠ 未提“未遂” |
| judgement_predit-3 | 盗伐林木罪        | ✅ 正确     |
| judgement_predit-4 | 非法占用农用地罪     | ✅ 正确     |
| judgement_predit-5 | 信用卡诈骗罪       | ✅ 正确     |

##### 👉 可量化指标

* **Crime Accuracy（罪名准确率）**
* 或 Top-1 / Top-k 命中

> ❗这是法律任务中**唯一可以接近“EM”的指标**



#### ② 法条引用是否正确 & 匹配

不是“有没有引用”，而是：

* **是否引用了对的条**
* **是否引用了关键条款**

##### 举例

* judgement_predit-2
  👉 应明确：**放火罪未遂**（刑法总则 + 分则）
* judgement_predit-5
  👉 正确区分了 **恶意透支 vs 盗窃信用卡**

##### 👉 指标设计

* Law Article Match（是否命中参考法条）
* Key Element Coverage（是否覆盖构成要件）



#### ③ 构成要件推理是否成立（最容易被忽略）

这是法律任务**比普通 NLP 难的核心原因**。

例如 judgement_predit-1：

* 行为是否“危害公共安全”？✅
* 是否“尚未造成严重后果”？✅
* 是否属于“危险方法”？✅

模型不是只说结论，而是**隐式完成了构成要件匹配**。

##### 👉 评测方式

* LLM Judge：

  > “模型是否合理说明了该罪名的构成要件？”
* 人工抽检（必须）


#### ④ 判罚区间是否在法定范围内

⚠ 注意：**这个任务不要求具体刑期**

##### 正确做法

* “三年以上十年以下有期徒刑” ✅
* “判处三年零六个月” ❌（越权）

##### 👉 指标

* Sentence Range Validity（是否合法区间）
* Over-Specification Rate（是否过度具体）

> 很多模型**会乱给具体年限，这是严重法律风险**



#### ⑤ 推理结构是否符合“法律三段论”

在样本 2 里**明确要求了这一点**，这是 benchmark 设计的加分项。

##### 合格结构：

1. **大前提**：法条
2. **小前提**：案件事实
3. **结论**：罪名 + 刑罚区间

##### 不合格：

* 直接给结论
* 法条和事实未显式关联
* 顺序混乱

##### 👉 指标

* Reasoning Structure Pass / Fail
* 可用规则或 LLM Judge



#### ⑥ 法律幻觉 & 不当推断（负向指标）

这在法律任务中是**红线指标**。

##### 包括：

* 编造不存在的法条
* 编造量刑情节（如“主犯”“累犯”）
* 未提“从轻/从重”的前提就擅自裁量

##### 👉 指标

* Hallucination Rate
* Unsupported Legal Claim Rate



### 三、把这 6 个指标“变成一个真正的 benchmark”

####  benchmark = 下面这张表

| 维度      | 类型   | 自动化         |
| ------- | ---- | ----------- |
| 罪名是否正确  | 硬指标  | ✅           |
| 法条是否匹配  | 半硬   | ✅           |
| 构成要件合理性 | 软    | ⚠ LLM Judge |
| 判罚区间合法  | 硬    | ✅           |
| 三段论结构   | 规则/软 | ⚠           |
| 法律幻觉    | 负向   | ⚠           |



#### 一个“标准评测输出 JSON”

```json
{
  "crime_correct": true,
  "law_article_match": true,
  "sentence_range_valid": true,
  "uses_legal_syllogism": true,
  "hallucination": false,
  "notes": "未明确说明未遂情节"
}
```



### 四、这类法律微调最容易犯的 3 个错误

1. ❌ 只评 ROUGE / BLEU
2. ❌ 只看“看起来像判决书”
3. ❌ 不区分「能不能判」和「判得合不合法」


### 五、总结一句人话版

> **法律领域的 benchmark，不是测“像不像法官”，而是测：**
> 👉 **“在规则约束下，是否做出了合法、可解释、不越权的推理结论”**
