
### 🎯 Embedding 测试集怎么做出来的？（面向双塔模型）

Embedding 用于 检索，所以测试集必须能验证——输入 query 时，是否能找到对应文档。

下面是常规手写评测集的制作步骤。

#### 步骤 1：收集真实 query

来源可以是：

- 客服系统真实用户问题
- 搜索日志（搜索词）
- QA 文档里的问题标题
- FAQ 标题集合
- 产品需求中可能出现的标准问题

要求：
- 多样化（短句 / 问句 / 命令式都要有）
- 覆盖所有业务主题

示例：
```
怎么申请退款？
对发票进行补开？
物流状态多久更新？
```

👉 这些 query 是测试集的核心。

#### 步骤 2：为每个 query 找到「正确答案文档」（positive）

方法有三个：

##### ① 人工标注（最准确）

标注人员从知识库中找到最能回答 query 的文档。

##### ② 根据 FAQ 匹配（半自动）

很多企业 FAQ 本身就有“问题 → 答案”结构。

##### ③ 规则自动匹配（自动生成候选 + 人工确认）

基于关键词找到疑似回答，再由人确认。

示例 positive 文档：
```
退货流程：在订单详情页点击“申请退货”，填写原因并提交即可。
```
#### 步骤 3：构造 negative 文档（负样本）

为了测试 embedding 的区分能力，必须为每个 query 生成：

- 冗余、不相关的文档
- 含糊但错误的内容（hard negative）

negative 来源：

##### ① 从知识库随机抽取无关文档（random negative）

例如：
```
如何修改密码？
会员积分怎样使用？
```
##### ② 构造 Hard Negative（强烈推荐）

Hard negative 是“看起来有点相关，但其实不是答案”的文档。

比如：
```
query：怎么申请退货？

hard negative：
退款多久到账？
退货运费谁承担？
```

👉 Hard negative 是测试集最关键的部分，因为它能逼出 embedding 的真实性能。

#### 步骤 4：最终 Embedding 测试集格式

示例测试数据：
```
{
  "query": "怎么申请退货？",
  "positives": [
    "在订单详情页点击申请退货即可。"
  ],
  "negatives": [
    "如何修改密码？",
    "积分如何兑换？",
    "退款多久到账？" // hard negative
  ]
}
```

测试集规模一般为：
- 小规模：50–200 条 query
- 中规模：300–1000 条
- 企业级：2k–5k 条
