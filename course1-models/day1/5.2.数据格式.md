## 数据格式

### 一、指令微调（Instruction / SFT）数据格式（最常用）
#### 1️⃣ Alpaca 格式（单轮指令）
```py
{
  "instruction": "解释什么是大模型",
  "input": "",
  "output": "大模型是指参数规模很大的神经网络模型..."
}
```

字段说明
- instruction：任务指令
- input：可选补充输入（可为空字符串）
- output：模型期望输出

📌 适用场景
- 单轮问答
- 基础指令跟随能力训练

#### 2️⃣ ShareGPT / Chat 格式（多轮对话）
```py
{
  "conversations": [
    { "from": "user", "value": "什么是 LLaMA？" },
    { "from": "assistant", "value": "LLaMA 是 Meta 提出的语言模型..." },
    { "from": "user", "value": "它有什么特点？" },
    { "from": "assistant", "value": "参数高效、性能优秀..." }
  ]
}
```

字段说明

- from：user / assistant / system
- value：对话内容

📌 适用场景
- Chat 模型
- 多轮对话微调（ChatML / Chat 模式）

### 二、偏好对齐数据（RLHF / DPO / ORPO）
3️⃣ Preference（偏好对比）格式
```py
{
  "prompt": "解释什么是 Transformer",
  "chosen": "Transformer 是一种基于注意力机制的模型...",
  "rejected": "Transformer 是一种传统的 RNN 模型..."
}
```

📌 用于
- DPO
- ORPO
- PPO（部分阶段）

### 三、预训练 / 续写数据格式
#### 4️⃣ 纯文本（Pretrain / Continual Pretrain）
```py
{
  "text": "今天我们讨论人工智能的发展历史..."
}
```

或直接是 txt 文件
```
今天我们讨论人工智能的发展历史……
```

📌 用于
- 继续预训练
- 领域语料适配

### 四、文件级支持格式（很重要）

LLaMA-Factory 在文件层面支持：

| 文件类型                | 是否支持       |
| ------------------- | ---------- |
| `.json`             | ✅          |
| `.jsonl`            | ✅（推荐，大数据集） |
| `.txt`              | ✅          |
| HuggingFace Dataset | ✅          |


### 五、自动字段映射（非常实用）

LLaMA-Factory 支持通过 dataset_info.json 做字段映射，例如：
```py
{
  "my_dataset": {
    "file_name": "data.json",
    "formatting": "alpaca",
    "columns": {
      "instruction": "question",
      "output": "answer"
    }
  }
}
```

👉 这意味着：

不要求你的字段名必须固定

可兼容几乎所有自定义数据集

### 六、格式与训练方式对应关系速览

| 训练方式               | 数据格式              |
| ------------------ | ----------------- |
| SFT                | Alpaca / ShareGPT |
| Chat 微调            | ShareGPT          |
| DPO / ORPO         | Preference        |
| Continual Pretrain | Text              |
| PPO                | Prompt + Response |



### 七、官方内置示例数据（参考）

LLaMA-Factory 内置支持：

- alpaca
- sharegpt
- openassistant
- self-instruct
- ultrachat
- hh-rlhf（偏好）

